clear all; close all;
cd(fileparts(mfilename('fullpath')));

FSTOP_AVERAGING = 20000000;
START_AVERAGING_100MV = 500;
STOP_AVERAGING = 1180;

Mean_input_100mV = [];
Mean_output_100mV = [];
Data100mVpp_noise0_math1 = importdata('./100mVpp/0spectrummath1.Wfm.csv');
Data100mVpp_noise0_math2 = importdata('./100mVpp/0spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise0_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise0_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise1_math1 = importdata('./100mVpp/1spectrummath1.Wfm.csv');
Data100mVpp_noise1_math2 = importdata('./100mVpp/1spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise1_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise1_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise2_math1 = importdata('./100mVpp/2spectrummath1.Wfm.csv');
Data100mVpp_noise2_math2 = importdata('./100mVpp/2spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise2_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise2_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise3_math1 = importdata('./100mVpp/3spectrummath1.Wfm.csv');
Data100mVpp_noise3_math2 = importdata('./100mVpp/3spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise3_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise3_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise4_math1 = importdata('./100mVpp/4spectrummath1.Wfm.csv');
Data100mVpp_noise4_math2 = importdata('./100mVpp/4spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise4_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise4_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise5_math1 = importdata('./100mVpp/5spectrummath1.Wfm.csv');
Data100mVpp_noise5_math2 = importdata('./100mVpp/5spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise5_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise5_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise6_math1 = importdata('./100mVpp/6spectrummath1.Wfm.csv');
Data100mVpp_noise6_math2 = importdata('./100mVpp/6spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise6_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise6_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise8_math1 = importdata('./100mVpp/8spectrummath1.Wfm.csv');
Data100mVpp_noise8_math2 = importdata('./100mVpp/8spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise8_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise8_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise10_math1 = importdata('./100mVpp/10spectrummath1.Wfm.csv');
Data100mVpp_noise10_math2 = importdata('./100mVpp/10spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise10_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise10_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise12_math1 = importdata('./100mVpp/12spectrummath1.Wfm.csv');
Data100mVpp_noise12_math2 = importdata('./100mVpp/12spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise12_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise12_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise15_math1 = importdata('./100mVpp/15spectrummath1.Wfm.csv');
Data100mVpp_noise15_math2 = importdata('./100mVpp/15spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise15_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise15_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise18_math1 = importdata('./100mVpp/18spectrummath1.Wfm.csv');
Data100mVpp_noise18_math2 = importdata('./100mVpp/18spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise18_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise18_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise20_math1 = importdata('./100mVpp/20spectrummath1.Wfm.csv');
Data100mVpp_noise20_math2 = importdata('./100mVpp/20spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise20_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise20_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise25_math1 = importdata('./100mVpp/25spectrummath1.Wfm.csv');
Data100mVpp_noise25_math2 = importdata('./100mVpp/25spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise25_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise25_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise35_math1 = importdata('./100mVpp/35spectrummath1.Wfm.csv');
Data100mVpp_noise35_math2 = importdata('./100mVpp/35spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise35_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise35_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise45_math1 = importdata('./100mVpp/45spectrummath1.Wfm.csv');
Data100mVpp_noise45_math2 = importdata('./100mVpp/45spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise45_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise45_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data100mVpp_noise50_math1 = importdata('./100mVpp/50spectrummath1.Wfm.csv');
Data100mVpp_noise50_math2 = importdata('./100mVpp/50spectrummath2.Wfm.csv');
Mean_input_100mV(end+1) = mean(Data100mVpp_noise50_math1(START_AVERAGING_100MV:STOP_AVERAGING));
Mean_output_100mV(end+1) = mean(Data100mVpp_noise50_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Noise_figure_100mV = abs(Mean_input_100mV-Mean_output_100mV);

START_AVERAGING_500MV = 200;
Mean_input_500mV = [];
Mean_output_500mV = [];

Data500mVpp_noise0_math1 = importdata('./500mVpp/0specmath1.Wfm.csv');
Data500mVpp_noise0_math2 = importdata('./500mVpp/0specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise0_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise0_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise1_math1 = importdata('./500mVpp/1specmath1.Wfm.csv');
Data500mVpp_noise1_math2 = importdata('./500mVpp/1specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise1_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise1_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise2_math1 = importdata('./500mVpp/2specmath1.Wfm.csv');
Data500mVpp_noise2_math2 = importdata('./500mVpp/2specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise2_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise2_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise3_math1 = importdata('./500mVpp/3specmath1.Wfm.csv');
Data500mVpp_noise3_math2 = importdata('./500mVpp/3specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise3_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise3_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise4_math1 = importdata('./500mVpp/4specmath1.Wfm.csv');
Data500mVpp_noise4_math2 = importdata('./500mVpp/4specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise4_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise4_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise5_math1 = importdata('./500mVpp/5specmath1.Wfm.csv');
Data500mVpp_noise5_math2 = importdata('./500mVpp/5specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise5_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise5_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise6_math1 = importdata('./500mVpp/6specmath1.Wfm.csv');
Data500mVpp_noise6_math2 = importdata('./500mVpp/6specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise6_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise6_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise8_math1 = importdata('./500mVpp/8specmath1.Wfm.csv');
Data500mVpp_noise8_math2 = importdata('./500mVpp/8specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise8_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise8_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise10_math1 = importdata('./500mVpp/10specmath1.Wfm.csv');
Data500mVpp_noise10_math2 = importdata('./500mVpp/10specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise10_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise10_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise12_math1 = importdata('./500mVpp/12specmath1.Wfm.csv');
Data500mVpp_noise12_math2 = importdata('./500mVpp/12specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise12_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise12_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise15_math1 = importdata('./500mVpp/15specmath1.Wfm.csv');
Data500mVpp_noise15_math2 = importdata('./500mVpp/15specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise15_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise15_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise18_math1 = importdata('./500mVpp/18specmath1.Wfm.csv');
Data500mVpp_noise18_math2 = importdata('./500mVpp/18specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise18_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise18_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise20_math1 = importdata('./500mVpp/20specmath1.Wfm.csv');
Data500mVpp_noise20_math2 = importdata('./500mVpp/20specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise20_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise20_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise25_math1 = importdata('./500mVpp/25specmath1.Wfm.csv');
Data500mVpp_noise25_math2 = importdata('./500mVpp/25specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise25_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise25_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise35_math1 = importdata('./500mVpp/35specmath1.Wfm.csv');
Data500mVpp_noise35_math2 = importdata('./500mVpp/35specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise35_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise35_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise45_math1 = importdata('./500mVpp/45specmath1.Wfm.csv');
Data500mVpp_noise45_math2 = importdata('./500mVpp/45specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise45_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise45_math2(START_AVERAGING_500MV:STOP_AVERAGING));
Data500mVpp_noise50_math1 = importdata('./500mVpp/50specmath1.Wfm.csv');
Data500mVpp_noise50_math2 = importdata('./500mVpp/50specmath2.Wfm.csv');
Mean_input_500mV(end+1) = mean(Data500mVpp_noise50_math1(START_AVERAGING_500MV:STOP_AVERAGING));
Mean_output_500mV(end+1) = mean(Data500mVpp_noise50_math2(START_AVERAGING_500MV:STOP_AVERAGING));

Noise_figure_500mV = abs(Mean_input_500mV-Mean_output_500mV);

START_AVERAGING_1000MV = 500;
Mean_input_1000mV = [];
Mean_output_1000mV = [];

Data1000mVpp_noise0_math1 = importdata('./1000mVpp/0spectrummath1.Wfm.csv');
Data1000mVpp_noise0_math2 = importdata('./1000mVpp/0spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise0_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise0_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise1_math1 = importdata('./1000mVpp/1spectrummath1.Wfm.csv');
Data1000mVpp_noise1_math2 = importdata('./1000mVpp/1spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise1_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise1_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise2_math1 = importdata('./1000mVpp/2spectrummath1.Wfm.csv');
Data1000mVpp_noise2_math2 = importdata('./1000mVpp/2spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise2_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise2_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise3_math1 = importdata('./1000mVpp/3spectrummath1.Wfm.csv');
Data1000mVpp_noise3_math2 = importdata('./1000mVpp/3spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise3_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise3_math2(START_AVERAGING_100MV:STOP_AVERAGING));
Data1000mVpp_noise4_math1 = importdata('./1000mVpp/4spectrummath1.Wfm.csv');
Data1000mVpp_noise4_math2 = importdata('./1000mVpp/4spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise4_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise4_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise5_math1 = importdata('./1000mVpp/5spectrummath1.Wfm.csv');
Data1000mVpp_noise5_math2 = importdata('./1000mVpp/5spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise5_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise5_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise6_math1 = importdata('./1000mVpp/6spectrummath1.Wfm.csv');
Data1000mVpp_noise6_math2 = importdata('./1000mVpp/6spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise6_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise6_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise8_math1 = importdata('./1000mVpp/8spectrummath1.Wfm.csv');
Data1000mVpp_noise8_math2 = importdata('./1000mVpp/8spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise8_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise8_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise10_math1 = importdata('./1000mVpp/10spectrummath1.Wfm.csv');
Data1000mVpp_noise10_math2 = importdata('./1000mVpp/10spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise10_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise10_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise12_math1 = importdata('./1000mVpp/12spectrummath1.Wfm.csv');
Data1000mVpp_noise12_math2 = importdata('./1000mVpp/12spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise12_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise12_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise15_math1 = importdata('./1000mVpp/15spectrummath1.Wfm.csv');
Data1000mVpp_noise15_math2 = importdata('./1000mVpp/15spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise15_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise15_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise18_math1 = importdata('./1000mVpp/18spectrummath1.Wfm.csv');
Data1000mVpp_noise18_math2 = importdata('./1000mVpp/18spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise18_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise18_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise20_math1 = importdata('./1000mVpp/20spectrummath1.Wfm.csv');
Data1000mVpp_noise20_math2 = importdata('./1000mVpp/20spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise20_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise20_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise25_math1 = importdata('./1000mVpp/25spectrummath1.Wfm.csv');
Data1000mVpp_noise25_math2 = importdata('./1000mVpp/25spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise25_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise25_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise35_math1 = importdata('./1000mVpp/35spectrummath1.Wfm.csv');
Data1000mVpp_noise35_math2 = importdata('./1000mVpp/35spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise35_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise35_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise45_math1 = importdata('./1000mVpp/45spectrummath1.Wfm.csv');
Data1000mVpp_noise45_math2 = importdata('./1000mVpp/45spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise45_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise45_math2(START_AVERAGING_1000MV:STOP_AVERAGING));
Data1000mVpp_noise50_math1 = importdata('./1000mVpp/50spectrummath1.Wfm.csv');
Data1000mVpp_noise50_math2 = importdata('./1000mVpp/50spectrummath2.Wfm.csv');
Mean_input_1000mV(end+1) = mean(Data1000mVpp_noise50_math1(START_AVERAGING_1000MV:STOP_AVERAGING));
Mean_output_1000mV(end+1) = mean(Data1000mVpp_noise50_math2(START_AVERAGING_1000MV:STOP_AVERAGING));

Noise_figure_1000mV = abs(Mean_input_1000mV-Mean_output_1000mV);

figure
noise_level = [0 1 2 3 4 5 6 8 10 12 15 18 20 25 35 45 50];
plot(noise_level, Noise_figure_100mV)
hold on
plot(noise_level, Noise_figure_500mV)
plot(noise_level, Noise_figure_1000mV)
hold off
ylabel('Noise Figure in dB');
xlabel('Noise in % of peak-to-peak voltage of signal');
legend('50mVpp','250mVpp', '500mVpp');
